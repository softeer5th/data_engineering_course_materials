## 리뷰

### 데일리 스크럼
  - 주영님: ETL의 구분이 어려웠다. 먼저 구현하고 나서 구분하며 의도를 파악하는 것이 필요하다.어제 했던 JSON 형태의 저장 또한 Load라면, 우리는 ELT를 구현한 것이다.
  - 도한님: ETL에 대한 개념이 불명확하다. 어제 있었던 __new__, __init__ 메소드에 대한 이해가 부족했다. 또한, Pandas에서 psutil로 프로파일링을 하여 병렬처리가 가능하다는 것을 코드로 알게 되었다. C로 구현되어 있어 빠르다는 것도 알게 되었다. 
  - 나: 엄밀히 말하면, 어제 했던 것은 Extract한 데이터를 그냥 분석 시에 Transform하여 사용하였다. 오늘 DB에 적재한다면 ETL에서 Load를 구현한 것이다.
  - Dano님이 말씀하신 것처럼 병렬, 분산 처리가 가능한지가 Transform 단계의 핵심이라고 생각한다.
  - 대용량 데이터 처리 중 에러가 난다면, 어떻게 처리할 것인지에 대한 계획이 필요하다. 서비스와 시나리오마다 다르기에 충분한 고민이 필요하다.
    
    개인적으로 생각할 땐
    1. DW, DM로 흘러가는 데이터 흐름 중에 에러가 발생한 경우
    2. 단순 행, 혹은 열 단위 에러인 경우
    3. 재난, 장애 등이 발생하여 EtLT의 한 과정 전체가 중단된 경우
  
  - 오늘 할 일: ETL Process 과제 추가 조건 수행하기 (DB 적재 및 세밀한 로그)

---

### 팀 활동 요구사항
Q: wikipeida 페이지가 아닌, IMF 홈페이지에서 직접 데이터를 가져오는 방법은 없을까요? 어떻게 하면 될까요?

A: API 호출이 가장 편하고 쉬운 방법이라고 생각한다. 아니면 동적 크롤링, csv 파일 다운로드 및 파싱이 필요할 것이다.

Q: 만약 데이터가 갱신되면 과거의 데이터는 어떻게 되어야 할까요? 과거의 데이터를 조회하는 게 필요하다면 ETL 프로세스를 어떻게 변경해야 할까요?

A: 타임스탬프 컬럼을 도입하여 버전 관리를 할 수 있다. 혹은, history 테이블에 데이터를 저장하여 관리할 수 있다. 즉, ETL 프로세스 중 Load 단계에 변화가 필요하다.

### ETL

**Transform**

변환: null 처리, 데이터 타입 변경 등 데이터를 분석하기 좋은 형태로 변환하는 과정.

DB에 Load하기 전에, 분산환경에서도 영향을 받지 않는지, 병렬처리가 가능한지 등을 고려해야 한다.

Q:분산환경에서도 가능한가?  

A:레코드 단위, chunk 단위로 진행해도 변환 작업이 영향받지 않아야 한다. 그러기 위하여 열 단위 변환을 적용하였다.

  - string -> int, float 변환
  - country로 region 매핑

Q:병렬처리가 가능한가?

A:선결 조건이 없다면 가능하다. 현재 ETL 과정에서는 선결조건이 변환 과정 중에는 없다.


**Load**

적재: 변환된 데이터를 데이터베이스에 저장하는 과정

Q: 처리 중 장애가 발생하면 어떻게 할 것인가?

A: 멱등성을 보장하여 재시도가 가능하게끔 한다 (단, 완전한 멱등성은 버전 관리가 중요할 때에는 존재하기 어려울 것 같다). 아직은 코드로 구현하지는 못하였다.

**어렵지만, 멱등성을 보장하며(?) 분산 환경 및 병렬처리가 가능하게 만들어야 한다.**

배치 단위로 데이터 처리를 수행할 때, 장애 조치로 인하여 다시 처리중인 데이터와 이전에 크롤링이 완료된 데이터가 존재할 때, 어떻게 같은 데이터라고 판단할 수 있으며, 이에 대한 멱등성이 보장이 될 것인가.

**SQL**
- ROW_NUMBER() OVER() 함수와 PARTITION을 활용하여 데이터를 정렬하고 순서를 부여
- WITH 구문을 활용하여 서브쿼리를 사용


**Python IMPORT**
- 파이썬은 PYTHONPATH 안에 존재하는 경로에 있는 모듈을 import할 수 있다.
- sys.path를 확인하여 PYTHONPATH 경로를 확인하고, append하여 경로를 추가할 수 있다. 
- 그게 아니라면, vscode의 설정, 환경 변수 도입 등으로 경로를 추가할 수 있다.
---

### Keep:계속 유지
- 중간중간 팀원들과 ETL 아키텍처, 더 깊은 원리적인 고민하기
- 근거와 예시를 들어가며 질문하기 (질문하기 전에 생각하면 더욱 좋다)

---

### Problem: 문제가 발생한 행동
- ETL 과정을 엄밀하게 하지 못하면 너무 많은 문제가 생길 것으로 예상된다
- 케바케이지만, 그럼에도 불구하고 시나리오 별 조치 케이스는 있을 것으로 생각하는데 잘 모르겠다

---
### Try: 다음 번에 새롭게 시도했으면 좋을 행동
- 아키텍처, 파이프라인에 대한 깊은 토의가 있었으면 좋겠다